generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model services {
  id               String             @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name             String
  description      String?
  price            Decimal            @db.Decimal(10, 2)
  created_at       DateTime?          @default(dbgenerated("timezone('utc'::text, now())")) @db.Timestamptz(6)
  service_bookings service_bookings[]
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model customers {
  user_id           String  @id @db.Uuid
  phone_number      String?
  address           String?
  emergency_contact String?
  preferences       Json?
  users             users   @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model payments {
  id              String        @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  reservation_id  String?       @db.Uuid
  amount          Decimal       @db.Decimal(10, 2)
  payment_method  String?
  status          String?       @default("pending")
  transaction_ref String?
  created_at      DateTime?     @default(dbgenerated("timezone('utc'::text, now())")) @db.Timestamptz(6)
  reservations    reservations? @relation(fields: [reservation_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model reservations {
  id               String             @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_id          String?            @db.Uuid
  room_id          String?            @db.Uuid
  check_in_date    DateTime           @db.Date
  check_out_date   DateTime           @db.Date
  total_price      Decimal            @db.Decimal(10, 2)
  status           String?            @default("pending")
  created_at       DateTime?          @default(dbgenerated("timezone('utc'::text, now())")) @db.Timestamptz(6)
  payments         payments[]
  rooms            rooms?             @relation(fields: [room_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  users            users?             @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  reviews          reviews[]
  service_bookings service_bookings[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model reviews {
  id             String        @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_id        String?       @db.Uuid
  reservation_id String?       @db.Uuid
  rating         Int?
  comment        String?
  created_at     DateTime?     @default(dbgenerated("timezone('utc'::text, now())")) @db.Timestamptz(6)
  reservations   reservations? @relation(fields: [reservation_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  users          users?        @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model room_types {
  id              String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name            String
  description     String?
  price_per_night Decimal   @db.Decimal(10, 2)
  capacity        Int?      @default(2)
  size_sqm        Int?
  amenities       Json?
  images          String[]
  created_at      DateTime? @default(dbgenerated("timezone('utc'::text, now())")) @db.Timestamptz(6)
  rooms           rooms[]
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model rooms {
  id           String         @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  room_type_id String?        @db.Uuid
  room_number  String
  status       String?        @default("available")
  created_at   DateTime?      @default(dbgenerated("timezone('utc'::text, now())")) @db.Timestamptz(6)
  reservations reservations[]
  room_images  room_images[]
  room_types   room_types?    @relation(fields: [room_type_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model service_bookings {
  id             String        @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  reservation_id String?       @db.Uuid
  service_id     String?       @db.Uuid
  quantity       Int?          @default(1)
  total_price    Decimal?      @db.Decimal(10, 2)
  created_at     DateTime?     @default(dbgenerated("timezone('utc'::text, now())")) @db.Timestamptz(6)
  reservations   reservations? @relation(fields: [reservation_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  services       services?     @relation(fields: [service_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model staff {
  id        String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_id   String?   @db.Uuid
  position  String?
  hired_at  DateTime? @default(dbgenerated("CURRENT_DATE")) @db.Date
  is_active Boolean?  @default(true)
  users     users?    @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model users {
  id             String           @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  email          String           @unique
  first_name     String?
  last_name      String?
  avatar_url     String?
  role           String?          @default("customer")
  created_at     DateTime?        @default(dbgenerated("timezone('utc'::text, now())")) @db.Timestamptz(6)
  user_name      String           @unique @default("") @db.VarChar
  user_password  String           @default("") @db.VarChar
  customers      customers?
  refresh_tokens refresh_tokens[]
  reservations   reservations[]
  reviews        reviews[]
  staff          staff[]
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model room_images {
  id            String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  room_id       String    @db.Uuid
  image_path    String    @db.VarChar(500)
  is_cover      Boolean?  @default(false)
  display_order Int?      @default(0)
  created_at    DateTime? @default(dbgenerated("timezone('utc'::text, now())")) @db.Timestamptz(6)
  rooms         rooms     @relation(fields: [room_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model refresh_tokens {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id    String   @db.Uuid
  token      String   @unique
  expires_at DateTime @db.Timestamp(6)
  created_at DateTime @default(dbgenerated("timezone('utc'::text, now())")) @db.Timestamptz(6)
  users      users    @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}
